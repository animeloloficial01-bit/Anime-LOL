<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#000000">
    <title>Anime LOL | IA Full Platform</title>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        :root {
            --primary: #47d1e0;
            --primary-glow: rgba(71, 209, 224, 0.4);
            --bg: #000000;
            --surface: #0a0a0a;
            --card-bg: #111;
            --text: #ffffff;
            --danger: #ff4757;
        }

        /* --- Estilos Globales --- */
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }
        body { background-color: var(--bg); color: var(--text); min-height: 100vh; overflow-x: hidden; }

        /* --- Login Overlay --- */
        #auth-screen {
            position: fixed; inset: 0; background: #000; z-index: 5000;
            display: flex; align-items: center; justify-content: center; padding: 20px;
        }
        .auth-box {
            background: #0a0a0a; padding: 40px; border-radius: 20px; border: 1px solid var(--primary);
            width: 100%; max-width: 400px; text-align: center; box-shadow: 0 0 30px var(--primary-glow);
        }
        .auth-box input {
            width: 100%; padding: 12px; margin: 10px 0; background: #111; border: 1px solid #333;
            color: white; border-radius: 10px; outline: none;
        }
        .btn-action {
            width: 100%; padding: 15px; background: var(--primary); color: #000;
            border: none; border-radius: 10px; font-weight: 900; cursor: pointer; transition: 0.3s;
        }

        /* --- Header --- */
        header {
            padding: 15px 5%; display: flex; justify-content: space-between; align-items: center;
            border-bottom: 1px solid #222; background: rgba(0,0,0,0.9); position: sticky; top: 0; z-index: 1000;
        }
        .logo { display: flex; align-items: center; gap: 10px; font-weight: 900; color: var(--primary); }

        /* --- Layout --- */
        .app-container { display: grid; grid-template-columns: 1fr 350px; gap: 20px; padding: 20px 5%; }

        /* --- Filtros --- */
        .filter-section { 
            display: grid; grid-template-columns: repeat(auto-fit, minmax(130px, 1fr)); 
            gap: 10px; margin-bottom: 25px; background: #0a0a0a; padding: 15px; border-radius: 12px;
        }
        select, .search-in { background: #1a1a1a; border: 1px solid #333; color: white; padding: 10px; border-radius: 8px; outline: none; }

        /* --- Grid de Animes --- */
        .anime-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 15px; }
        .anime-card {
            background: var(--card-bg); border-radius: 12px; overflow: hidden; border: 1px solid #222;
            position: relative; transition: 0.3s; cursor: pointer;
        }
        .anime-card:hover { border-color: var(--primary); transform: translateY(-5px); }
        .anime-card img { width: 100%; height: 230px; object-fit: cover; }
        
        .badge-match { position: absolute; top: 10px; left: 10px; background: rgba(0,0,0,0.8); color: var(--primary); padding: 4px 8px; border-radius: 5px; font-size: 0.6rem; font-weight: 900; border: 1px solid var(--primary); }
        .badge-censura { position: absolute; top: 10px; right: 10px; background: var(--danger); padding: 4px 8px; border-radius: 5px; font-size: 0.6rem; font-weight: 900; }

        /* --- Chat Global --- */
        .chat-sidebar { background: #0a0a0a; border: 1px solid #222; border-radius: 20px; height: 600px; display: flex; flex-direction: column; sticky; top: 90px; }
        #chat-render { flex: 1; padding: 15px; overflow-y: auto; font-size: 0.8rem; }
        .chat-msg { background: #161616; padding: 10px; border-radius: 10px; margin-bottom: 8px; border-left: 3px solid var(--primary); }
        .chat-control { padding: 15px; border-top: 1px solid #222; display: flex; gap: 10px; }

        /* --- Modal Detalle & Trailer --- */
        #modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 2000; padding: 20px; overflow-y: auto; }
        .modal-body { max-width: 700px; margin: auto; padding-bottom: 50px; }
        .video-box { position: relative; padding-bottom: 56.25%; height: 0; border-radius: 15px; overflow: hidden; background: #000; margin-bottom: 20px; }
        .video-box iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; }
        .ai-summary-box { background: rgba(71,209,224,0.1); border: 1px solid var(--primary); padding: 20px; border-radius: 15px; margin: 20px 0; line-height: 1.6; }

        @media (max-width: 900px) { .app-container { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

    <div id="auth-screen">
        <div class="auth-box">
            <img src="1000371388.png" width="60" style="margin-bottom:10px; filter:drop-shadow(0 0 10px var(--primary))">
            <h2 style="color:var(--primary); margin-bottom:10px;">ANIME LOL IA</h2>
            <p style="font-size:0.7rem; color:#888; margin-bottom:20px;">INGRESA A LA RED GLOBAL</p>
            <input type="text" id="login-user" placeholder="Nombre de usuario">
            <input type="password" id="login-pass" placeholder="Contrase√±a">
            <button class="btn-action" onclick="login()">ACCEDER</button>
        </div>
    </div>

    <header>
        <div class="logo">
            <img src="1000371388.png" height="30" onerror="this.style.display='none'">
            <span>ANIME LOL</span>
        </div>
        <div id="user-display" style="font-size:0.8rem; font-weight:900; color:var(--primary);"></div>
    </header>

    <main class="app-container">
        <section>
            <div class="filter-section">
                <input type="text" id="s-name" class="search-in" placeholder="Nombre del anime...">
                <select id="s-genre">
                    <option value="">G√©neros</option>
                    <option value="1">Acci√≥n</option><option value="10">Fantas√≠a</option><option value="22">Romance</option><option value="4">Comedia</option>
                </select>
                <select id="s-type">
                    <option value="">Origen</option>
                    <option value="tv">Jap√≥n (TV)</option>
                    <option value="ona">ONA (China/Corea)</option>
                </select>
                <input type="number" id="s-year" class="search-in" placeholder="A√±o" min="1990" max="2026">
                <button class="btn-action" style="padding:10px;" onclick="runSearch()"><i class="fas fa-search"></i></button>
            </div>

            <button id="btn-oracle" class="btn-action" style="margin-bottom:20px; background: linear-gradient(90deg, #47d1e0, #9b59b6); color:white;" onclick="oracleAI()">üîÆ CONSULTAR OR√ÅCULO IA</button>

            <div class="anime-grid" id="main-grid"></div>
        </section>

        <aside>
            <div class="chat-sidebar">
                <div style="padding:15px; text-align:center; border-bottom:1px solid #222; font-size:0.7rem; font-weight:900;">üì° LIVE CHAT GLOBAL</div>
                <div id="chat-render"></div>
                <div class="chat-control">
                    <input type="text" id="chat-input" placeholder="Escribe algo..." style="flex:1; background:#111; border:1px solid #333; color:white; padding:8px; border-radius:8px;">
                    <button onclick="sendMessage()" style="background:var(--primary); border:none; padding:10px 15px; border-radius:8px;"><i class="fas fa-paper-plane"></i></button>
                </div>
            </div>
        </aside>
    </main>

    <div id="modal">
        <div class="modal-body">
            <button class="btn-action" style="width:auto; margin-bottom:20px;" onclick="closeModal()">‚úï VOLVER</button>
            <div class="video-box" id="trailer-box"></div>
            <h2 id="m-title" style="color:var(--primary); margin-bottom:10px;"></h2>
            
            <div class="ai-summary-box">
                <h4 style="font-size:0.8rem; color:var(--primary); margin-bottom:10px;">üß† RESUMEN E IMPULSI√ìN IA:</h4>
                <p id="m-summary" style="font-size:0.9rem; opacity:0.9;"></p>
            </div>

            <div id="m-meta" style="font-size:0.8rem; color:#888; display:flex; gap:15px; margin-bottom:20px;"></div>
            <button class="btn-action" style="background:none; border:1px solid var(--primary); color:var(--primary);" onclick="markCap()">MARCAR CAP√çTULO VISTO</button>
        </div>
    </div>

    <script>
        let userActive = "";

        // 1. Login
        function login() {
            const u = document.getElementById('login-user').value;
            const p = document.getElementById('login-pass').value;
            if(u.length < 3 || p.length < 3) return alert("Completa los datos");
            userActive = u;
            document.getElementById('user-display').innerText = `@${u.toUpperCase()}`;
            document.getElementById('auth-screen').style.display = 'none';
            runSearch();
        }

        // 2. Buscador Avanzado
        async function runSearch() {
            const grid = document.getElementById('main-grid');
            const name = document.getElementById('s-name').value;
            const genre = document.getElementById('s-genre').value;
            const type = document.getElementById('s-type').value;
            const year = document.getElementById('s-year').value;

            grid.innerHTML = "<p>Iniciando escaneo IA...</p>";
            
            let url = `https://api.jikan.moe/v4/anime?q=${name}&limit=16&genres=${genre}&type=${type}&start_date=${year ? year+'-01-01' : ''}&order_by=score&sort=desc`;
            
            try {
                const res = await fetch(url);
                const { data } = await res.json();
                grid.innerHTML = '';
                data.forEach(a => {
                    const match = Math.floor(Math.random() * 20) + 80;
                    const isAdult = a.rating && a.rating.includes('R');
                    grid.innerHTML += `
                        <div class="anime-card" onclick='openModal(${JSON.stringify(a).replace(/'/g, "&apos;")})'>
                            <div class="badge-match">${match}% MATCH IA</div>
                            ${isAdult ? '<div class="badge-censura">+18</div>' : ''}
                            <img src="${a.images.jpg.large_image_url}" loading="lazy">
                            <div style="padding:10px; font-size:0.75rem; font-weight:700; height:40px; overflow:hidden;">${a.title}</div>
                        </div>
                    `;
                });
            } catch (e) { grid.innerHTML = "Error de conexi√≥n."; }
        }

        // 3. Modal & Trailers & IA Summary
        function openModal(a) {
            document.getElementById('m-title').innerText = a.title;
            document.getElementById('m-summary').innerText = (a.synopsis || "Sin descripci√≥n.")
                .replace(/is a/g, "es un").replace(/The story/g, "La historia") + 
                "\n\n[AN√ÅLISIS IA: Recomendado por su alto impacto visual y narrativa de tipo " + a.type + "].";
            
            const trailerBox = document.getElementById('trailer-box');
            if(a.trailer && a.trailer.youtube_id) {
                trailerBox.innerHTML = `<iframe src="https://www.youtube.com/embed/${a.trailer.youtube_id}?autoplay=1" allowfullscreen></iframe>`;
            } else {
                trailerBox.innerHTML = "<div style='padding:60px; text-align:center;'>Trailer no disponible</div>";
            }

            document.getElementById('m-meta').innerHTML = `<span>A√±o: ${a.year || 'N/A'}</span> <span>Rating: ${a.rating}</span>`;
            document.getElementById('modal').style.display = 'block';
        }

        function closeModal() {
            document.getElementById('modal').style.display = 'none';
            document.getElementById('trailer-box').innerHTML = '';
        }

        // 4. Chat Global
        function sendMessage() {
            const cin = document.getElementById('chat-input');
            const render = document.getElementById('chat-render');
            if(!cin.value) return;
            const msg = document.createElement('div');
            msg.className = 'chat-msg';
            msg.innerHTML = `<b>@${userActive}:</b> ${cin.value}`;
            render.appendChild(msg);
            cin.value = '';
            render.scrollTop = render.scrollHeight;
        }

        function oracleAI() {
            alert("üîÆ El Or√°culo IA predice que hoy deber√≠as ver un anime de Acci√≥n. ¬°Escanea la lista!");
        }

        function markCap() {
            const cap = prompt("¬øEn qu√© cap√≠tulo vas?");
            if(cap) alert("Cap√≠tulo " + cap + " guardado en la memoria de la IA.");
        }
    </script>
</body>
</html>
